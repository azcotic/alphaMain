"use strict";(self.webpackChunkModernize=self.webpackChunkModernize||[]).push([[248],{248:(mt,I,s)=>{s.r(I),s.d(I,{PrintersRoutes:()=>ct});var f=s(177),C=s(5596),h=s(8834),_=s(9213),c=s(9159),m=s(4006),d=s(9417),u=s(2102),E=s(9631),v=s(2798),F=s(5084),k=s(3),S=s(2765),t=s(4438),P=s(4796);function w(n,a){if(1&n&&(t.j41(0,"mat-option",31),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function $(n,a){if(1&n&&(t.j41(0,"mat-option",31),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e),t.R7$(),t.SpI(" ",e," ")}}function x(n,a){if(1&n&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",e.name,"")}}function T(n,a){if(1&n&&(t.j41(0,"mat-option",31),t.DNE(1,x,2,1,"span",32),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e),t.R7$(),t.Y8G("ngIf",e)}}function G(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",29),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.onSave())}),t.EFF(1,"Guardar"),t.k0s()}}let j=(()=>{class n{constructor(e,o,r,i){if(this.fb=e,this.dialogRef=o,this.auth=r,this.data=i,this.optionsForStatus=["asignada","sin asignar","enajenada","desincorporada"],this.optionsForModel=["AEG-R1"],this.optionsForSoftware=[{name:"",_id:""}],this.softwareSelected={name:"",_id:""},this.isEdit=i.isEdit,this.optionsForModel=i.optionsForModel,this.optionsForSoftware=i.optionsForSoftware,console.log(this.optionsForSoftware),console.log(i.printer.softwareToBeUsed),i.printer.softwareToBeUsed&&(this.softwareSelected=this.optionsForSoftware.find(l=>l._id===i.printer.softwareToBeUsed),console.log(this.softwareSelected)),this.isEdit){this.precint=i.printer.precint?i.printer.precint:"";let l=i.printer.assignedTo?i.printer.assignedTo:"",p=i.printer.clientId?i.printer.clientId:"";console.log(i.sucursalData),this.printerForm=this.fb.group({modelo:[{value:i.printer.model,disabled:!0}],serial:[{value:i.printer.serialNumber,disabled:!0}],precinto:[{value:i.printer.precint?i.printer.precint.code:"",disabled:!0}],estado:[{value:i.printer.estado,disabled:!this.isEdit}],actualizada:[{value:!0,disabled:!0}],firmwareVersion:[{value:i.printer.firmwareVersion,disabled:!0}],clientId:[{value:p.nombreFiscal,disabled:!1}],invoiceNumber:[{value:i.printer.invoiceNumber,disabled:!1}],sucursal:[{value:i.sucursalData?i.sucursalData.nombre:"N/A",disabled:!1}],dateInstallation:[{value:i.printer.dateInstallation,disabled:!1}],lastRevision:[{value:i.printer.lastRevision,disabled:!1}],status:[{value:i.printer.status,disabled:!1}],modifiedBy:[{value:i.printer.modifiedBy,disabled:!1}],dateModified:[{value:i.printer.dateModified,disabled:!1}],dateCreated:[{value:i.printer.dateCreated,disabled:!1}],assigned:[{value:i.printer.assigned,disabled:!1}],assignedTo:[{value:l.name,disabled:!1}],marca:[{value:i.printer.marca,disabled:!1}],macAddress:[{value:i.printer.macAddress,disabled:!0}],footers:[{value:i.printer.footers,disabled:!1}],headers:[{value:i.printer.headers,disabled:!1}],software:[{value:this.softwareSelected,disabled:!1}]})}else if(!this.isNew){this.precint=i.printer.precint?i.printer.precint:"";let l=i.printer.assignedTo?i.printer.assignedTo:"",p=i.printer.clientId?i.printer.clientId:"";console.log(i.sucursalData),this.printerForm=this.fb.group({modelo:[{value:i.printer.model,disabled:!this.isEdit}],serial:[{value:i.printer.serialNumber,disabled:!1}],precinto:[{value:i.printer.precint?i.printer.precint.code:"",disabled:!1}],estado:[{value:i.printer.estado,disabled:!this.isEdit}],actualizada:[{value:!0,disabled:!0}],firmwareVersion:[{value:i.printer.firmwareVersion,disabled:!1}],clientId:[{value:p.nombreFiscal,disabled:!1}],invoiceNumber:[{value:i.printer.invoiceNumber,disabled:!1}],sucursal:[{value:i.sucursalData?i.sucursalData.nombre:"N/A",disabled:!1}],dateInstallation:[{value:i.printer.dateInstallation,disabled:!1}],lastRevision:[{value:i.printer.lastRevision,disabled:!1}],status:[{value:i.printer.status,disabled:!1}],modifiedBy:[{value:i.printer.modifiedBy,disabled:!1}],dateModified:[{value:i.printer.dateModified,disabled:!1}],dateCreated:[{value:i.printer.dateCreated,disabled:!1}],assigned:[{value:i.printer.assigned,disabled:!1}],assignedTo:[{value:l.name,disabled:!1}],marca:[{value:i.printer.marca,disabled:!1}],macAddress:[{value:i.printer.macAddress,disabled:!1}],footers:[{value:i.printer.footers,disabled:!1}],headers:[{value:i.printer.headers,disabled:!1}],software:[{value:this.softwareSelected,disabled:!1}]})}}onSave(){this.isEdit?this.dialogRef.close(this.printerForm.value):this.dialogRef.close()}onStatusChange(e){this.auth.getUserData().subscribe(o=>{"administrador"===o.permissionName?this.printerForm.get("estado")?.setValue(e.value):this.printerForm.get("estado")?.setValue(this.printerForm.get("estado")?.value)})}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(d.ok),t.rXU(m.CP),t.rXU(P.u),t.rXU(m.Vh))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-printer-dialog"]],features:[t.Jv_([(0,k.aw)()])],decls:85,vars:32,consts:[["picker1",""],["picker2",""],["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],[1,"printer-form",3,"formGroup"],[2,"display","flex","gap","16px"],["appearance","outline",1,"form-field",2,"flex","0.3"],["formControlName","modelo",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","serial",3,"readonly"],["appearance","outline",1,"form-field",2,"flex","0.4"],["matInput","","formControlName","macAddress",3,"readonly"],["matInput","","formControlName","firmwareVersion",3,"readonly"],["matInput","","formControlName","precinto",3,"readonly"],["formControlName","estado",3,"selectionChange","disabled"],["matInput","","formControlName","assignedTo",3,"readonly"],["matInput","","formControlName","invoiceNumber",3,"readonly"],["formControlName","actualizada",2,"flex","0.4",3,"disabled"],["appearance","outline",1,"form-field",2,"flex","0.5"],["matInput","","formControlName","clientId",3,"readonly"],["matInput","","formControlName","sucursal",3,"readonly"],["formControlName","software",3,"disabled"],["matInput","","formControlName","dateInstallation",3,"matDatepicker","readonly"],["matSuffix","",3,"for","disabled"],[3,"disabled"],["matInput","","formControlName","lastRevision",3,"matDatepicker","readonly"],["matInput","","formControlName","headers",3,"readonly"],["matInput","","formControlName","footers",3,"readonly"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",3,"click"],["mat-button","",3,"click",4,"ngIf"],[3,"value"],[4,"ngIf"]],template:function(o,r){if(1&o){const i=t.RV6();t.j41(0,"h1",2),t.EFF(1),t.k0s(),t.j41(2,"div",3)(3,"form",4)(4,"div",5)(5,"mat-form-field",6)(6,"mat-label"),t.EFF(7,"Modelo"),t.k0s(),t.j41(8,"mat-select",7),t.DNE(9,w,2,2,"mat-option",8),t.k0s()(),t.j41(10,"mat-form-field",6)(11,"mat-label"),t.EFF(12,"Serial"),t.k0s(),t.nrm(13,"input",9),t.k0s(),t.j41(14,"mat-form-field",10)(15,"mat-label"),t.EFF(16,"Direcci\xf3n MAC"),t.k0s(),t.nrm(17,"input",11),t.k0s()(),t.j41(18,"div",5)(19,"mat-form-field",6)(20,"mat-label"),t.EFF(21,"Versi\xf3n de Firmware"),t.k0s(),t.nrm(22,"input",12),t.k0s(),t.j41(23,"mat-form-field",6)(24,"mat-label"),t.EFF(25,"Precinto"),t.k0s(),t.nrm(26,"input",13),t.k0s(),t.j41(27,"mat-form-field",10)(28,"mat-label"),t.EFF(29,"Estado"),t.k0s(),t.j41(30,"mat-select",14),t.bIt("selectionChange",function(p){return t.eBV(i),t.Njj(r.onStatusChange(p))}),t.DNE(31,$,2,2,"mat-option",8),t.k0s()()(),t.j41(32,"div",5)(33,"mat-form-field",6)(34,"mat-label"),t.EFF(35,"Distribuidor Asignado"),t.k0s(),t.nrm(36,"input",15),t.k0s(),t.j41(37,"mat-form-field",6)(38,"mat-label"),t.EFF(39,"N\xb0 de factura"),t.k0s(),t.nrm(40,"input",16),t.k0s(),t.j41(41,"mat-checkbox",17),t.EFF(42,"Actualizada"),t.k0s()(),t.j41(43,"div",5)(44,"mat-form-field",18)(45,"mat-label"),t.EFF(46,"Cliente"),t.k0s(),t.nrm(47,"input",19),t.k0s(),t.j41(48,"mat-form-field",18)(49,"mat-label"),t.EFF(50,"Sucursal"),t.k0s(),t.nrm(51,"input",20),t.k0s()(),t.j41(52,"div",5)(53,"mat-form-field",10)(54,"mat-label"),t.EFF(55,"Software Usado"),t.k0s(),t.j41(56,"mat-select",21),t.DNE(57,T,2,2,"mat-option",8),t.k0s()(),t.j41(58,"mat-form-field",6)(59,"mat-label"),t.EFF(60,"Fecha de Instalaci\xf3n"),t.k0s(),t.nrm(61,"input",22)(62,"mat-datepicker-toggle",23)(63,"mat-datepicker",24,0),t.k0s(),t.j41(65,"mat-form-field",6)(66,"mat-label"),t.EFF(67,"\xdaltima Revisi\xf3n"),t.k0s(),t.nrm(68,"input",25)(69,"mat-datepicker-toggle",23)(70,"mat-datepicker",24,1),t.k0s()(),t.j41(72,"div",5)(73,"mat-form-field",18)(74,"mat-label"),t.EFF(75,"Headers"),t.k0s(),t.nrm(76,"input",26),t.k0s(),t.j41(77,"mat-form-field",18)(78,"mat-label"),t.EFF(79,"Footers"),t.k0s(),t.nrm(80,"input",27),t.k0s()()()(),t.j41(81,"div",28)(82,"button",29),t.bIt("click",function(){return t.eBV(i),t.Njj(r.onCancel())}),t.EFF(83,"Cancelar"),t.k0s(),t.DNE(84,G,2,0,"button",30),t.k0s()}if(2&o){const i=t.sdS(64),l=t.sdS(71);t.R7$(),t.JRh(r.isEdit?"Editar Impresora":"Ver Impresora"),t.R7$(2),t.Y8G("formGroup",r.printerForm),t.R7$(5),t.Y8G("disabled",!r.isEdit),t.R7$(),t.Y8G("ngForOf",r.optionsForModel),t.R7$(4),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("readonly",!r.isEdit),t.R7$(5),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Aen("color:"+r.precint.colorCode),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("disabled",!r.isEdit),t.R7$(),t.Y8G("ngForOf",r.optionsForStatus),t.R7$(5),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("readonly",!r.isEdit),t.R7$(),t.Y8G("disabled",!r.isEdit),t.R7$(6),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("readonly",!r.isEdit),t.R7$(5),t.Y8G("disabled",!r.isEdit),t.R7$(),t.Y8G("ngForOf",r.optionsForSoftware),t.R7$(4),t.Y8G("matDatepicker",i)("readonly",!r.isEdit),t.R7$(),t.Y8G("for",i)("disabled",!r.isEdit),t.R7$(),t.Y8G("disabled",!r.isEdit),t.R7$(5),t.Y8G("matDatepicker",l)("readonly",!r.isEdit),t.R7$(),t.Y8G("for",l)("disabled",!r.isEdit),t.R7$(),t.Y8G("disabled",!r.isEdit),t.R7$(6),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("readonly",!r.isEdit),t.R7$(4),t.Y8G("ngIf",r.isEdit)}},dependencies:[f.MD,f.Sq,f.bT,C.Hu,h.Hl,h.$z,_.m_,c.tP,m.hM,m.BI,m.E7,m.Yi,d.X1,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,u.RG,u.rl,u.nJ,u.yw,E.fS,E.fg,v.Ve,v.VO,k.wT,F.X6,F.Vh,F.bZ,F.bU,S.g7,S.So],styles:[".mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}.dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-field[_ngcontent-%COMP%]{width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}  .mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:20px!important}"]})}}return n})();var g=s(1626),N=s(7673),R=s(8141),b=s(9437),O=s(5312),y=s(7473);let D=(()=>{class n{constructor(e,o){this.http=e,this.notificationService=o,this.apiUrl=O.c.apiUrl+"/printers"}getPrinters(){const e=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.get(`${this.apiUrl}`,{headers:e}).pipe((0,R.M)(o=>{console.log("Printers fetched successfully",o)}),(0,b.W)(this.handleError("getPrinters",[])))}updatePrinter(e,o){const r=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.put(`${this.apiUrl}/${e}`,o,{headers:r}).pipe((0,R.M)(i=>{console.log("Printer updated successfully",i),this.notificationService.showSuccess("Printer updated successfully")}),(0,b.W)(this.handleError("updatePrinter",[])))}assignPrinterToUser(e,o){const r=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.post(`${this.apiUrl}/assignPrinter`,{userId:o,printerId:e},{headers:r}).pipe((0,b.W)(this.handleError("assignPrinterToUser",[])))}getDetailOfPrinter(e){const o=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.get(`${this.apiUrl}/${e}`,{headers:o}).pipe((0,b.W)(this.handleError("getDetailOfPrinter",[])))}handleError(e="operation",o){return r=>(console.error(r),this.notificationService.showError(`${e} failed: ${r.message}`),(0,N.of)(o))}deletePrinter(e){const o=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.delete(`${this.apiUrl}/${e}`,{headers:o}).pipe((0,R.M)(r=>{console.log("Impresora borrada exitosamente",r),this.notificationService.showSuccess("Impresora borrada exitosamente")}),(0,b.W)(this.handleError("deletePrinter",{})))}generateReport(e,o,r){const i=(new g.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.post(`${this.apiUrl}/generateReport`,{from:e,to:o,key:r},{headers:i}).pipe((0,b.W)(this.handleError("generateReport",[])))}static{this.\u0275fac=function(o){return new(o||n)(t.KVO(g.Qq),t.KVO(y.J))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function M(n,a){if(1&n&&(t.j41(0,"mat-option",9),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.Y8G("value",e._id),t.R7$(),t.SpI(" ",e.name+" | "+e.username," ")}}let V=(()=>{class n{constructor(e,o,r,i,l,p){this.fb=e,this.dialogRef=o,this.printerService=r,this.data=i,this.notificationService=l,this.authService=p,this.users=[],this.assignForm=this.fb.group({user:[null]})}ngOnInit(){this.authService.getDistribuidores().subscribe(e=>{1===e.code&&(this.users=e.data)})}onAssign(){this.assignForm.valid?this.printerService.assignPrinterToUser(this.data.printer._id,this.assignForm.value.user).subscribe(e=>{1===e.code?(this.notificationService.showSuccess("Impresora asignada correctamente"),this.dialogRef.close(!0)):this.notificationService.showError("Error al asignar la impresora")}):this.notificationService.showError("Cliente no seleccionado")}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(d.ok),t.rXU(m.CP),t.rXU(D),t.rXU(m.Vh),t.rXU(y.J),t.rXU(P.u))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-assign-printer-dialog"]],decls:14,vars:2,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],[1,"assign-form",3,"formGroup"],["appearance","outline",1,"form-field"],["formControlName","user"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],[3,"value"]],template:function(o,r){1&o&&(t.j41(0,"h1",0),t.EFF(1,"Asignar Impresora a Distribuidor"),t.k0s(),t.j41(2,"div",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),t.EFF(6,"Distribuidor"),t.k0s(),t.j41(7,"mat-select",4),t.DNE(8,M,2,2,"mat-option",5),t.k0s()()()(),t.j41(9,"div",6)(10,"button",7),t.bIt("click",function(){return r.onCancel()}),t.EFF(11,"Cancelar"),t.k0s(),t.j41(12,"button",8),t.bIt("click",function(){return r.onAssign()}),t.EFF(13,"Asignar"),t.k0s()()),2&o&&(t.R7$(3),t.Y8G("formGroup",r.assignForm),t.R7$(5),t.Y8G("ngForOf",r.users))},dependencies:[f.MD,f.Sq,C.Hu,h.Hl,h.$z,_.m_,c.tP,m.hM,m.BI,m.E7,m.Yi,d.X1,d.qT,d.BC,d.cb,d.j4,d.JD,u.RG,u.rl,u.nJ,E.fS,v.Ve,v.VO,k.wT],styles:[".dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px}.assign-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-field[_ngcontent-%COMP%]{width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}"]})}}return n})();var U=s(8257);function Y(n,a){1&n&&(t.j41(0,"span"),t.EFF(1," asignadas"),t.k0s())}function A(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",5),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.openAddPrinter())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s(),t.EFF(3," Agregar Impresora "),t.k0s()}}function X(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",6),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.generateReport())}),t.j41(1,"mat-icon"),t.EFF(2,"file"),t.k0s(),t.EFF(3," Generar Reporte "),t.k0s()}}function B(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Modelo "),t.k0s())}function L(n,a){if(1&n&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.SpI(" ",e.modelo," ")}}function z(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Serial "),t.k0s())}function H(n,a){if(1&n&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.SpI(" ",e.serial," ")}}function J(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Precinto "),t.k0s())}function W(n,a){if(1&n&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.SpI(" ",e.precinto," ")}}function Z(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Estado "),t.k0s())}function K(n,a){if(1&n&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.SpI(" ",e.estado," ")}}function Q(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Version "),t.k0s())}function q(n,a){if(1&n&&(t.j41(0,"td",19),t.EFF(1),t.k0s()),2&n){const e=a.$implicit;t.R7$(),t.SpI(" ",e.firmwareVersion," ")}}function tt(n,a){1&n&&(t.j41(0,"th",18),t.EFF(1," Acciones "),t.k0s())}function et(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,i=t.XpG(2);return t.Njj(i.openAssignDialog(r))}),t.EFF(1,"Asignar"),t.k0s()}}function it(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",23),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,i=t.XpG(2);return t.Njj(i.openEdit(r))}),t.EFF(1,"Editar"),t.k0s()}}function nt(n,a){if(1&n){const e=t.RV6();t.j41(0,"button",24),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,i=t.XpG(2);return t.Njj(i.deletePrinter(r._id))}),t.EFF(1,"Borrar"),t.k0s()}}function rt(n,a){if(1&n){const e=t.RV6();t.j41(0,"td",19)(1,"button",20),t.bIt("click",function(){const r=t.eBV(e).$implicit,i=t.XpG(2);return t.Njj(i.openView(r))}),t.EFF(2,"Detalles"),t.k0s(),t.DNE(3,et,2,0,"button",21)(4,it,2,0,"button",21)(5,nt,2,0,"button",22),t.k0s()}if(2&n){const e=a.$implicit,o=t.XpG(2);t.R7$(3),t.Y8G("ngIf",0==o.typeOfUser&&"sin asignar"==e.estado),t.R7$(),t.Y8G("ngIf",0==o.typeOfUser),t.R7$(),t.Y8G("ngIf",0==o.typeOfUser)}}function ot(n,a){1&n&&t.nrm(0,"tr",25)}function at(n,a){1&n&&t.nrm(0,"tr",26)}function st(n,a){if(1&n&&(t.j41(0,"div")(1,"table",7),t.qex(2,8),t.DNE(3,B,2,0,"th",9)(4,L,2,1,"td",10),t.bVm(),t.qex(5,11),t.DNE(6,z,2,0,"th",9)(7,H,2,1,"td",10),t.bVm(),t.qex(8,12),t.DNE(9,J,2,0,"th",9)(10,W,2,1,"td",10),t.bVm(),t.qex(11,13),t.DNE(12,Z,2,0,"th",9)(13,K,2,1,"td",10),t.bVm(),t.qex(14,14),t.DNE(15,Q,2,0,"th",9)(16,q,2,1,"td",10),t.bVm(),t.qex(17,15),t.DNE(18,tt,2,0,"th",9)(19,rt,6,3,"td",10),t.bVm(),t.DNE(20,ot,1,0,"tr",16)(21,at,1,0,"tr",17),t.k0s()()),2&n){const e=t.XpG();t.R7$(),t.Y8G("dataSource",e.printers),t.R7$(19),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",e.displayedColumns)}}function lt(n,a){1&n&&(t.j41(0,"div")(1,"p"),t.EFF(2,"Cargando impresoras..."),t.k0s()())}function dt(n,a){1&n&&(t.j41(0,"div")(1,"p"),t.EFF(2,"No hay impresoras disponibles."),t.k0s()())}const ct=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"",children:[{path:"list",component:(()=>{class n{constructor(e,o,r,i){this.printerService=e,this.notificationService=o,this.authService=r,this.dialog=i,this.printers=[],this.typeOfUser=5,this.softwaresArray=[],this.displayedColumns=["modelo","serial","precinto","estado","firmwareVersion","acciones"],this.modelPrinters=[],this.isLoading=!1}ngOnInit(){this.authService.getTypeOfUser().subscribe(e=>{this.typeOfUser=e}),this.isLoading=!0,this.printerService.getPrinters().subscribe(e=>{1==e.code?(this.printers=e.data,this.modelPrinters=e.modelAvailable,this.softwaresArray=e.softwaresAvailable):this.notificationService.showError("Error al obtener las impresoras"),this.isLoading=!1})}openAddPrinter(){}openView(e){this.printerService.getDetailOfPrinter(e._id).subscribe(o=>{1==o.code&&this.dialog.open(j,{width:"1000px",data:{printer:o.data,sucursalData:o.sucursalData,isEdit:!1,optionsForModel:this.modelPrinters,optionsForSoftware:this.softwaresArray}})})}openAssignDialog(e){this.dialog.open(V,{width:"600px",data:{printer:e}}).afterClosed().subscribe(r=>{r&&this.ngOnInit()})}deletePrinter(e){this.dialog.open(U.D,{width:"400px",data:{message:"\xbfEst\xe1 seguro de que desea eliminar esta impresora?"}}).afterClosed().subscribe(r=>{r&&this.printerService.deletePrinter(e).subscribe(i=>{1==i.code?(this.notificationService.showSuccess("Impresora eliminado correctamente"),this.ngOnInit()):(console.log(i),this.notificationService.showError(i.message))})})}generateReport(){this.printerService.generateReport("01/05/2025","07/05/2025","Haosalsalsa").subscribe(e=>{if(1===e.code&&e.data&&e.fileName){const o=new Uint8Array(e.data.data),r=new Blob([o],{type:"application/octet-stream"}),i=e.fileName,l=document.createElement("a"),p=URL.createObjectURL(r);l.href=p,l.download=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(p),this.notificationService.showSuccess(e.message||"Reporte generado y descarga iniciada.")}else 1===e.code?(this.notificationService.showError("Respuesta del servidor inv\xe1lida para la descarga del reporte."),console.error("Invalid data for report download:",e)):this.notificationService.showError(e.message||"Error al generar el reporte")},e=>{this.notificationService.showError("Error de comunicaci\xf3n al generar el reporte."),console.error("Error subscribing to generateReport:",e)})}openEdit(e){this.printerService.getDetailOfPrinter(e._id).subscribe(o=>{1==o.code&&this.dialog.open(j,{width:"1000px",data:{printer:o.data,isEdit:!0,sucursalData:o.sucursalData,optionsForModel:this.modelPrinters,optionsForSoftware:this.softwaresArray}}).afterClosed().subscribe(i=>{i&&this.printerService.updatePrinter(e._id,i).subscribe(l=>{1==l.code?(this.notificationService.showSuccess("Impresora actualizada correctamente"),this.ngOnInit()):this.notificationService.showError("Error al actualizar la impresora")})})})}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(D),t.rXU(y.J),t.rXU(P.u),t.rXU(m.bZ))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-printers"]],decls:11,vars:6,consts:[[1,"printers-container"],[1,"title"],[4,"ngIf"],["mat-raised-button","","color","primary","class","add-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"add-button",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8","printers-table",3,"dataSource"],["matColumnDef","modelo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","serial"],["matColumnDef","precinto"],["matColumnDef","estado"],["matColumnDef","firmwareVersion"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-stroked-button","","color","accent",2,"margin-right","5px",3,"click"],["mat-flat-button","","color","warn","style","margin-right: 5px;",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","style","margin-right: 5px;",3,"click",4,"ngIf"],["mat-flat-button","","color","warn",2,"margin-right","5px",3,"click"],["mat-raised-button","","color","primary",2,"margin-right","5px",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"h2",1),t.EFF(2,"Lista de Impresoras "),t.DNE(3,Y,2,0,"span",2),t.k0s(),t.DNE(4,A,4,0,"button",3),t.nrm(5,"br")(6,"br"),t.DNE(7,X,4,0,"button",4)(8,st,22,3,"div",2)(9,lt,3,0,"div",2)(10,dt,3,0,"div",2),t.k0s()),2&o&&(t.R7$(3),t.Y8G("ngIf",1==r.typeOfUser),t.R7$(),t.Y8G("ngIf",0==r.typeOfUser),t.R7$(3),t.Y8G("ngIf",0==r.typeOfUser),t.R7$(),t.Y8G("ngIf",r.printers&&r.printers.length>0),t.R7$(),t.Y8G("ngIf",r.isLoading),t.R7$(),t.Y8G("ngIf",!r.printers||0===r.printers.length&&!r.isLoading))},dependencies:[f.MD,f.bT,C.Hu,h.Hl,h.$z,_.m_,_.An,c.tP,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB],styles:[".printers-container[_ngcontent-%COMP%]{position:relative;padding:16px}.title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin-bottom:16px;color:#3f51b5}.printers-table[_ngcontent-%COMP%]{width:100%;margin-top:40px}.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:left}.mat-header-cell[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:700;border-bottom:2px solid #e0e0e0}.mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.mat-row[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.mat-button[_ngcontent-%COMP%]{color:#1976d2}.mat-elevation-z8[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b}.add-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px}"]})}}return n})()}]}]}}]);