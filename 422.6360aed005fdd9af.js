"use strict";(self.webpackChunkModernize=self.webpackChunkModernize||[]).push([[422],{422:(he,w,l)=>{l.r(w),l.d(w,{PrintersRoutes:()=>_e});var f=l(177),C=l(5596),g=l(8834),_=l(9213),d=l(9159),m=l(4006),c=l(9417),u=l(2102),v=l(9631),h=l(2798),b=l(5084),F=l(3),R=l(2765),e=l(4438),E=l(4796),k=l(1438);function j(i,s){if(1&i&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function D(i,s){if(1&i&&(e.j41(0,"mat-option",35)(1,"span"),e.EFF(2),e.k0s()()),2&i){const t=s.$implicit;e.Y8G("value",t.color),e.R7$(),e.xc7("color",t.colorCode),e.R7$(),e.JRh(t.color)}}function S(i,s){if(1&i){const t=e.RV6();e.j41(0,"mat-form-field",36)(1,"mat-label"),e.EFF(2,"Color de Precinto"),e.k0s(),e.j41(3,"mat-select",37),e.bIt("selectionChange",function(o){e.eBV(t);const a=e.XpG();return e.Njj(a.onColorChange(o))}),e.DNE(4,D,3,4,"mat-option",9),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(3),e.Y8G("formControl",t.colorControl),e.R7$(),e.Y8G("ngForOf",t.precintoColors)}}function G(i,s){if(1&i&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t.code),e.R7$(),e.SpI(" ",t.code," ")}}function $(i,s){if(1&i&&(e.j41(0,"mat-form-field",38)(1,"mat-label"),e.EFF(2,"C\xf3digo de Precinto"),e.k0s(),e.j41(3,"mat-select",39),e.DNE(4,G,2,2,"mat-option",9),e.k0s()()),2&i){const t=e.XpG();e.R7$(3),e.Y8G("formControl",t.codigoControl)("disabled",!t.colorControl.value),e.R7$(),e.Y8G("ngForOf",t.precintoCodigos)}}function y(i,s){if(1&i&&(e.j41(0,"mat-form-field",40)(1,"mat-label"),e.EFF(2,"Precinto"),e.k0s(),e.nrm(3,"input",41),e.k0s()),2&i){const t=e.XpG();e.R7$(3),e.Aen("color:"+t.precint.colorCode),e.Y8G("readonly",!t.isEdit&&!t.isNew)}}function T(i,s){if(1&i&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.SpI(" ",t," ")}}function x(i,s){if(1&i&&(e.j41(0,"mat-option",35),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t._id),e.R7$(),e.Lme(" ",t.nombreFiscal," - ",t.rif," ")}}function V(i,s){if(1&i&&(e.qex(0),e.j41(1,"mat-form-field",23)(2,"mat-label"),e.EFF(3,"Cliente"),e.k0s(),e.j41(4,"mat-select",42),e.DNE(5,x,2,3,"mat-option",9),e.k0s()(),e.bVm()),2&i){const t=e.XpG();e.R7$(5),e.Y8G("ngForOf",t.optionsForClients)}}function Y(i,s){if(1&i&&(e.j41(0,"mat-form-field",23)(1,"mat-label"),e.EFF(2,"Cliente"),e.k0s(),e.nrm(3,"input",43),e.k0s()),2&i){let t;const r=e.XpG();e.R7$(3),e.Y8G("value",null==(t=r.printerForm.get("clientId"))?null:t.value)}}function O(i,s){if(1&i&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.name,"")}}function M(i,s){if(1&i&&(e.j41(0,"mat-option",35),e.DNE(1,O,2,1,"span",44),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t),e.R7$(),e.Y8G("ngIf",t)}}function A(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onSave())}),e.EFF(1,"Guardar"),e.k0s()}}function X(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",33),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onSave())}),e.EFF(1,"Crear Impresora"),e.k0s()}}let P=(()=>{class i{constructor(t,r,o,a,n){if(this.fb=t,this.dialogRef=r,this.auth=o,this.printerService=a,this.data=n,this.optionsForStatus=["asignada","sin asignar","enajenada","desincorporada"],this.optionsForModel=["AEG-R1"],this.optionsForSoftware=[{name:"",_id:""}],this.optionsForClients=[],this.softwareSelected={name:"",_id:""},this.precintoColors=[],this.precintoCodigos=[],this.colorControl=new c.MJ(""),this.codigoControl=new c.MJ(""),this.selectedColor="",this.selectedCodigo="",this.isEdit=n.isEdit,this.isNew=n.isNew,this.optionsForModel=n.optionsForModel,this.optionsForSoftware=n.optionsForSoftware,this.optionsForClients=n.optionsForClients||[],console.log(this.data),n.printer?.softwareToBeUsed&&(this.softwareSelected=this.optionsForSoftware.find(p=>p._id===n.printer.softwareToBeUsed),console.log(this.softwareSelected)),this.isEdit)this.precint=n.printer.precint?n.printer.precint:"",console.log(n.sucursalData),this.printerForm=this.fb.group({modelo:[{value:n.printer.model,disabled:!0}],serial:[{value:n.printer.serialNumber,disabled:!0}],precinto:[{value:n.printer.precint?n.printer.precint.code:"",disabled:!0}],estado:[{value:n.printer.estado,disabled:!this.isEdit}],actualizada:[{value:!0,disabled:!0}],firmwareVersion:[{value:n.printer.firmwareVersion,disabled:!0}],clientId:[{value:n.printer.clientId?._id||"",disabled:!1}],invoiceNumber:[{value:n.printer.invoiceNumber,disabled:!1}],sucursal:[{value:n.sucursalData?n.sucursalData.nombre:"N/A",disabled:!1}],dateInstallation:[{value:n.printer.dateInstallation,disabled:!1}],lastRevision:[{value:n.printer.lastRevision,disabled:!1}],status:[{value:n.printer.status,disabled:!1}],modifiedBy:[{value:n.printer.modifiedBy,disabled:!1}],dateModified:[{value:n.printer.dateModified,disabled:!1}],dateCreated:[{value:n.printer.dateCreated,disabled:!1}],assigned:[{value:n.printer.assigned,disabled:!1}],assignedTo:[{value:n.printer.assignedTo?.name||"",disabled:!1}],marca:[{value:n.printer.marca,disabled:!1}],macAddress:[{value:n.printer.macAddress,disabled:!0}],footers:[{value:n.printer.footers,disabled:!1}],headers:[{value:n.printer.headers,disabled:!1}],software:[{value:this.softwareSelected,disabled:!1}]});else if(this.isNew)this.printerForm=this.fb.group({modelo:[""],serial:[""],precinto:[""],estado:[""],actualizada:[!1],firmwareVersion:[""],clientId:[""],invoiceNumber:[""],sucursal:[""],dateInstallation:[""],lastRevision:[""],status:[!0],modifiedBy:[""],dateModified:[""],dateCreated:[""],assigned:[!1],assignedTo:[""],marca:[""],macAddress:[""],footers:[""],headers:[""],software:[""]});else{this.precint=n.printer.precint?n.printer.precint:"";let p=n.printer.assignedTo?n.printer.assignedTo:"",N=n.printer.clientId?n.printer.clientId:"";console.log(n.sucursalData),this.printerForm=this.fb.group({modelo:[{value:n.printer.model,disabled:!this.isEdit}],serial:[{value:n.printer.serialNumber,disabled:!1}],precinto:[{value:n.printer.precint?n.printer.precint.code:"",disabled:!1}],estado:[{value:n.printer.estado,disabled:!this.isEdit}],actualizada:[{value:!0,disabled:!0}],firmwareVersion:[{value:n.printer.firmwareVersion,disabled:!1}],clientId:[{value:N.nombreFiscal,disabled:!1}],invoiceNumber:[{value:n.printer.invoiceNumber,disabled:!1}],sucursal:[{value:n.sucursalData?n.sucursalData.nombre:"N/A",disabled:!1}],dateInstallation:[{value:n.printer.dateInstallation,disabled:!1}],lastRevision:[{value:n.printer.lastRevision,disabled:!1}],status:[{value:n.printer.status,disabled:!1}],modifiedBy:[{value:n.printer.modifiedBy,disabled:!1}],dateModified:[{value:n.printer.dateModified,disabled:!1}],dateCreated:[{value:n.printer.dateCreated,disabled:!1}],assigned:[{value:n.printer.assigned,disabled:!1}],assignedTo:[{value:p.name,disabled:!1}],marca:[{value:n.printer.marca,disabled:!1}],macAddress:[{value:n.printer.macAddress,disabled:!1}],footers:[{value:n.printer.footers,disabled:!1}],headers:[{value:n.printer.headers,disabled:!1}],software:[{value:this.softwareSelected,disabled:!1}]})}}ngOnInit(){this.data.optionsForPrecintos&&(this.precintoColors=this.data.optionsForPrecintos.map(t=>({color:t.color,colorCode:t.colorCode})).filter((t,r,o)=>r===o.findIndex(a=>a.color===t.color))),this.isNew&&this.printerForm.get("modelo")?.valueChanges.subscribe(t=>{t&&this.printerForm.get("serial")?.setValue("GRA")})}onColorChange(t){this.colorControl.setValue(t.value),this.selectedColor=t.value,this.printerService.getPrecintos("",this.selectedColor).subscribe(r=>{1==r.code?this.precintoCodigos=r.data:this.data.progressService&&this.data.progressService.showSnackBarError&&this.data.progressService.showSnackBarError("Error obteniendo precintos")}),this.codigoControl.setValue(""),this.selectedCodigo=""}onSave(){if(this.isNew){const t={...this.printerForm.value,precintColor:this.colorControl.value,precintNumber:this.codigoControl.value};this.data.createPrinter&&this.data.createPrinter({serialNumber:t.serial,model:t.modelo,estado:t.estado,firmwareVersion:t.firmwareVersion,precintColor:t.precintColor,precintNumber:t.precintNumber,macAddress:t.macAddress},this.dialogRef)}else this.isEdit?this.dialogRef.close({...this.printerForm.value,precintColor:this.colorControl.value,precintNumber:this.codigoControl.value}):this.dialogRef.close()}onStatusChange(t){this.isNew?this.printerForm.get("estado")?.setValue(t.value):this.auth.getUserData().subscribe(r=>{"administrador"===r.permissionName?this.printerForm.get("estado")?.setValue(t.value):this.printerForm.get("estado")?.setValue(this.printerForm.get("estado")?.value)})}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(c.ok),e.rXU(m.CP),e.rXU(E.u),e.rXU(k.k),e.rXU(m.Vh))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-printer-dialog"]],features:[e.Jv_([(0,F.aw)()])],decls:85,vars:34,consts:[["viewCliente",""],["picker1",""],["picker2",""],["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],[1,"printer-form",3,"formGroup"],[2,"display","flex","gap","16px"],["appearance","outline",1,"form-field",2,"flex","0.3"],["formControlName","modelo",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","serial",3,"readonly"],["appearance","outline",1,"form-field",2,"flex","0.4"],["matInput","","formControlName","macAddress",3,"readonly"],["matInput","","formControlName","firmwareVersion",3,"readonly"],["appearance","outline","class","input-field","style","flex: 0.3;",4,"ngIf"],["appearance","outline","class","input-field","style","flex: 0.4;",4,"ngIf"],["class","form-field","style","flex: 0.7;","appearance","outline",4,"ngIf"],["appearance","outline",1,"form-field",2,"flex","1"],["formControlName","estado",3,"selectionChange","disabled"],["matInput","","formControlName","assignedTo",3,"readonly"],["matInput","","formControlName","invoiceNumber",3,"readonly"],["formControlName","actualizada",2,"flex","0.4",3,"disabled"],[4,"ngIf","ngIfElse"],["appearance","outline",1,"form-field",2,"flex","0.5"],["matInput","","formControlName","sucursal",3,"readonly"],["formControlName","software",3,"disabled"],["matInput","","formControlName","dateInstallation",3,"matDatepicker","readonly"],["matSuffix","",3,"for","disabled"],[3,"disabled"],["matInput","","formControlName","lastRevision",3,"matDatepicker","readonly"],["matInput","","formControlName","headers",3,"readonly"],["matInput","","formControlName","footers",3,"readonly"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",3,"click"],["mat-button","",3,"click",4,"ngIf"],[3,"value"],["appearance","outline",1,"input-field",2,"flex","0.3"],[3,"selectionChange","formControl"],["appearance","outline",1,"input-field",2,"flex","0.4"],[3,"formControl","disabled"],["appearance","outline",1,"form-field",2,"flex","0.7"],["matInput","","formControlName","precinto",3,"readonly"],["formControlName","clientId"],["matInput","","readonly","",3,"value"],[4,"ngIf"]],template:function(r,o){if(1&r){const a=e.RV6();e.j41(0,"h1",3),e.EFF(1),e.k0s(),e.j41(2,"div",4)(3,"form",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e.EFF(7,"Modelo"),e.k0s(),e.j41(8,"mat-select",8),e.DNE(9,j,2,2,"mat-option",9),e.k0s()(),e.j41(10,"mat-form-field",7)(11,"mat-label"),e.EFF(12,"Serial"),e.k0s(),e.nrm(13,"input",10),e.k0s(),e.j41(14,"mat-form-field",11)(15,"mat-label"),e.EFF(16,"Direcci\xf3n MAC"),e.k0s(),e.nrm(17,"input",12),e.k0s()(),e.j41(18,"div",6)(19,"mat-form-field",7)(20,"mat-label"),e.EFF(21,"Versi\xf3n de Firmware"),e.k0s(),e.nrm(22,"input",13),e.k0s(),e.DNE(23,S,5,2,"mat-form-field",14)(24,$,5,3,"mat-form-field",15)(25,y,4,3,"mat-form-field",16),e.k0s(),e.j41(26,"div",6)(27,"mat-form-field",17)(28,"mat-label"),e.EFF(29,"Estado"),e.k0s(),e.j41(30,"mat-select",18),e.bIt("selectionChange",function(p){return e.eBV(a),e.Njj(o.onStatusChange(p))}),e.DNE(31,T,2,2,"mat-option",9),e.k0s()()(),e.j41(32,"div",6)(33,"mat-form-field",7)(34,"mat-label"),e.EFF(35,"Distribuidor Asignado"),e.k0s(),e.nrm(36,"input",19),e.k0s(),e.j41(37,"mat-form-field",7)(38,"mat-label"),e.EFF(39,"N\xb0 de factura"),e.k0s(),e.nrm(40,"input",20),e.k0s(),e.j41(41,"mat-checkbox",21),e.EFF(42,"Actualizada"),e.k0s()(),e.j41(43,"div",6),e.DNE(44,V,6,1,"ng-container",22)(45,Y,4,1,"ng-template",null,0,e.C5r),e.j41(47,"mat-form-field",23)(48,"mat-label"),e.EFF(49,"Sucursal"),e.k0s(),e.nrm(50,"input",24),e.k0s()(),e.j41(51,"div",6)(52,"mat-form-field",11)(53,"mat-label"),e.EFF(54,"Software Usado"),e.k0s(),e.j41(55,"mat-select",25),e.DNE(56,M,2,2,"mat-option",9),e.k0s()(),e.j41(57,"mat-form-field",7)(58,"mat-label"),e.EFF(59,"Fecha de Instalaci\xf3n"),e.k0s(),e.nrm(60,"input",26)(61,"mat-datepicker-toggle",27)(62,"mat-datepicker",28,1),e.k0s(),e.j41(64,"mat-form-field",7)(65,"mat-label"),e.EFF(66,"\xdaltima Revisi\xf3n"),e.k0s(),e.nrm(67,"input",29)(68,"mat-datepicker-toggle",27)(69,"mat-datepicker",28,2),e.k0s()(),e.j41(71,"div",6)(72,"mat-form-field",23)(73,"mat-label"),e.EFF(74,"Headers"),e.k0s(),e.nrm(75,"input",30),e.k0s(),e.j41(76,"mat-form-field",23)(77,"mat-label"),e.EFF(78,"Footers"),e.k0s(),e.nrm(79,"input",31),e.k0s()()()(),e.j41(80,"div",32)(81,"button",33),e.bIt("click",function(){return e.eBV(a),e.Njj(o.onCancel())}),e.EFF(82,"Cancelar"),e.k0s(),e.DNE(83,A,2,0,"button",34)(84,X,2,0,"button",34),e.k0s()}if(2&r){const a=e.sdS(46),n=e.sdS(63),p=e.sdS(70);e.R7$(),e.SpI(" ",o.isNew?"Crear Impresora":o.isEdit?"Editar Impresora":"Ver Impresora","\n"),e.R7$(2),e.Y8G("formGroup",o.printerForm),e.R7$(5),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("ngForOf",o.optionsForModel),e.R7$(4),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(4),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(5),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("ngIf",o.isNew||o.isEdit),e.R7$(),e.Y8G("ngIf",o.isNew||o.isEdit),e.R7$(),e.Y8G("ngIf",!o.isNew&&!o.isEdit),e.R7$(5),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("ngForOf",o.optionsForStatus),e.R7$(5),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(4),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(3),e.Y8G("ngIf",o.isNew||o.isEdit)("ngIfElse",a),e.R7$(6),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(5),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("ngForOf",o.optionsForSoftware),e.R7$(4),e.Y8G("matDatepicker",n)("readonly",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("for",n)("disabled",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(5),e.Y8G("matDatepicker",p)("readonly",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("for",p)("disabled",!o.isEdit&&!o.isNew),e.R7$(),e.Y8G("disabled",!o.isEdit&&!o.isNew),e.R7$(6),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(4),e.Y8G("readonly",!o.isEdit&&!o.isNew),e.R7$(4),e.Y8G("ngIf",o.isEdit),e.R7$(),e.Y8G("ngIf",o.isNew)}},dependencies:[f.MD,f.Sq,f.bT,C.Hu,g.Hl,g.$z,_.m_,d.tP,m.hM,m.BI,m.E7,m.Yi,c.X1,c.qT,c.me,c.BC,c.cb,c.l_,c.j4,c.JD,u.RG,u.rl,u.nJ,u.yw,v.fS,v.fg,h.Ve,h.VO,F.wT,b.X6,b.Vh,b.bZ,b.bU,R.g7,R.So],styles:[".mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}.dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-field[_ngcontent-%COMP%]{width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}  .mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:20px!important}"]})}}return i})();var I=l(7473);function U(i,s){if(1&i&&(e.j41(0,"mat-option",9),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.Y8G("value",t._id),e.R7$(),e.SpI(" ",t.name+" | "+t.username," ")}}let B=(()=>{class i{constructor(t,r,o,a,n,p){this.fb=t,this.dialogRef=r,this.printerService=o,this.data=a,this.notificationService=n,this.authService=p,this.users=[],this.assignForm=this.fb.group({user:[null]})}ngOnInit(){this.authService.getDistribuidores().subscribe(t=>{1===t.code&&(this.users=t.data)})}onAssign(){this.assignForm.valid?this.printerService.assignPrinterToUser(this.data.printer._id,this.assignForm.value.user).subscribe(t=>{1===t.code?(this.notificationService.showSuccess("Impresora asignada correctamente"),this.dialogRef.close(!0)):this.notificationService.showError("Error al asignar la impresora")}):this.notificationService.showError("Cliente no seleccionado")}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(c.ok),e.rXU(m.CP),e.rXU(k.k),e.rXU(m.Vh),e.rXU(I.J),e.rXU(E.u))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-assign-printer-dialog"]],decls:14,vars:2,consts:[["mat-dialog-title","",1,"dialog-title"],["mat-dialog-content","",1,"dialog-content"],[1,"assign-form",3,"formGroup"],["appearance","outline",1,"form-field"],["formControlName","user"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","",1,"dialog-actions"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],[3,"value"]],template:function(r,o){1&r&&(e.j41(0,"h1",0),e.EFF(1,"Asignar Impresora a Distribuidor"),e.k0s(),e.j41(2,"div",1)(3,"form",2)(4,"mat-form-field",3)(5,"mat-label"),e.EFF(6,"Distribuidor"),e.k0s(),e.j41(7,"mat-select",4),e.DNE(8,U,2,2,"mat-option",5),e.k0s()()()(),e.j41(9,"div",6)(10,"button",7),e.bIt("click",function(){return o.onCancel()}),e.EFF(11,"Cancelar"),e.k0s(),e.j41(12,"button",8),e.bIt("click",function(){return o.onAssign()}),e.EFF(13,"Asignar"),e.k0s()()),2&r&&(e.R7$(3),e.Y8G("formGroup",o.assignForm),e.R7$(5),e.Y8G("ngForOf",o.users))},dependencies:[f.MD,f.Sq,C.Hu,g.Hl,g.$z,_.m_,d.tP,m.hM,m.BI,m.E7,m.Yi,c.X1,c.qT,c.BC,c.cb,c.j4,c.JD,u.RG,u.rl,u.nJ,v.fS,h.Ve,h.VO,F.wT],styles:[".dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;padding:16px}.assign-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-field[_ngcontent-%COMP%]{width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}"]})}}return i})();var z=l(8257),H=l(9398);function J(i,s){1&i&&(e.j41(0,"span"),e.EFF(1," asignadas"),e.k0s())}function L(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",5),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.openAddPrinter())}),e.j41(1,"mat-icon"),e.EFF(2,"add"),e.k0s(),e.EFF(3," Agregar Impresora "),e.k0s()}}function Z(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",6),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.generateReport())}),e.j41(1,"mat-icon"),e.EFF(2,"file"),e.k0s(),e.EFF(3," Generar Reporte "),e.k0s()}}function K(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Modelo "),e.k0s())}function Q(i,s){if(1&i&&(e.j41(0,"td",19),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.modelo," ")}}function W(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Serial "),e.k0s())}function q(i,s){if(1&i&&(e.j41(0,"td",19),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.serial," ")}}function ee(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Precinto "),e.k0s())}function te(i,s){if(1&i&&(e.j41(0,"td",19),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.precinto," ")}}function ie(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Estado "),e.k0s())}function oe(i,s){if(1&i&&(e.j41(0,"td",19),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.estado," ")}}function ne(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Version "),e.k0s())}function re(i,s){if(1&i&&(e.j41(0,"td",19),e.EFF(1),e.k0s()),2&i){const t=s.$implicit;e.R7$(),e.SpI(" ",t.firmwareVersion," ")}}function se(i,s){1&i&&(e.j41(0,"th",18),e.EFF(1," Acciones "),e.k0s())}function ae(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.openAssignDialog(o))}),e.EFF(1,"Asignar"),e.k0s()}}function le(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.openEdit(o))}),e.EFF(1,"Editar"),e.k0s()}}function ce(i,s){if(1&i){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const o=e.XpG().$implicit,a=e.XpG(2);return e.Njj(a.deletePrinter(o._id))}),e.EFF(1,"Borrar"),e.k0s()}}function de(i,s){if(1&i){const t=e.RV6();e.j41(0,"td",19)(1,"button",20),e.bIt("click",function(){const o=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.openView(o))}),e.EFF(2,"Detalles"),e.k0s(),e.DNE(3,ae,2,0,"button",21)(4,le,2,0,"button",21)(5,ce,2,0,"button",22),e.k0s()}if(2&i){const t=s.$implicit,r=e.XpG(2);e.R7$(3),e.Y8G("ngIf",0==r.typeOfUser&&"sin asignar"==t.estado),e.R7$(),e.Y8G("ngIf",0==r.typeOfUser),e.R7$(),e.Y8G("ngIf",0==r.typeOfUser)}}function me(i,s){1&i&&e.nrm(0,"tr",25)}function pe(i,s){1&i&&e.nrm(0,"tr",26)}function fe(i,s){if(1&i&&(e.j41(0,"div")(1,"table",7),e.qex(2,8),e.DNE(3,K,2,0,"th",9)(4,Q,2,1,"td",10),e.bVm(),e.qex(5,11),e.DNE(6,W,2,0,"th",9)(7,q,2,1,"td",10),e.bVm(),e.qex(8,12),e.DNE(9,ee,2,0,"th",9)(10,te,2,1,"td",10),e.bVm(),e.qex(11,13),e.DNE(12,ie,2,0,"th",9)(13,oe,2,1,"td",10),e.bVm(),e.qex(14,14),e.DNE(15,ne,2,0,"th",9)(16,re,2,1,"td",10),e.bVm(),e.qex(17,15),e.DNE(18,se,2,0,"th",9)(19,de,6,3,"td",10),e.bVm(),e.DNE(20,me,1,0,"tr",16)(21,pe,1,0,"tr",17),e.k0s()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("dataSource",t.printers),e.R7$(19),e.Y8G("matHeaderRowDef",t.displayedColumns),e.R7$(),e.Y8G("matRowDefColumns",t.displayedColumns)}}function ue(i,s){1&i&&(e.j41(0,"div")(1,"p"),e.EFF(2,"Cargando impresoras..."),e.k0s()())}function ge(i,s){1&i&&(e.j41(0,"div")(1,"p"),e.EFF(2,"No hay impresoras disponibles."),e.k0s()())}const _e=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"",children:[{path:"list",component:(()=>{class i{constructor(t,r,o,a,n){this.printerService=t,this.clientService=r,this.notificationService=o,this.authService=a,this.dialog=n,this.printers=[],this.typeOfUser=5,this.softwaresArray=[],this.precintos=[],this.clients=[],this.displayedColumns=["modelo","serial","precinto","estado","firmwareVersion","acciones"],this.modelPrinters=[],this.isLoading=!1}ngOnInit(){this.authService.getTypeOfUser().subscribe(t=>{this.typeOfUser=t}),this.isLoading=!0,this.printerService.getPrinters().subscribe(t=>{1==t.code?(this.printers=t.data,this.modelPrinters=t.modelAvailable,this.softwaresArray=t.softwaresAvailable):this.notificationService.showError("Error al obtener las impresoras"),this.isLoading=!1}),this.clientService.getClients().subscribe(t=>{1==t.code?this.clients=t.data:this.notificationService.showError("Error al obtener los clientes")}),this.printerService.getPrecintos().subscribe(t=>{1===t.code?this.precintos=t.data||[]:this.notificationService.showError("Error al obtener los precintos")})}openAddPrinter(){this.dialog.open(P,{width:"1000px",data:{isEdit:!1,isNew:!0,optionsForModel:this.modelPrinters,optionsForSoftware:this.softwaresArray,optionsForPrecintos:this.precintos,optionsForClients:this.clients,createPrinter:(t,r)=>{this.printerService.createPrinter(t).subscribe(o=>{1===o.code?(this.notificationService.showSuccess("Impresora creada correctamente"),r.close(!0),this.ngOnInit()):this.notificationService.showError(o.message||"Error al crear la impresora")},o=>{this.notificationService.showError("Error de comunicaci\xf3n al crear la impresora"),console.error("Error creando impresora:",o)})}}})}openView(t){this.printerService.getDetailOfPrinter(t._id).subscribe(r=>{1==r.code&&this.dialog.open(P,{width:"1000px",data:{printer:r.data,sucursalData:r.sucursalData,isEdit:!1,optionsForModel:this.modelPrinters,optionsForSoftware:this.softwaresArray}})})}openAssignDialog(t){this.dialog.open(B,{width:"600px",data:{printer:t}}).afterClosed().subscribe(o=>{o&&this.ngOnInit()})}deletePrinter(t){this.dialog.open(z.D,{width:"400px",data:{message:"\xbfEst\xe1 seguro de que desea eliminar esta impresora?"}}).afterClosed().subscribe(o=>{o&&this.printerService.deletePrinter(t).subscribe(a=>{1==a.code?(this.notificationService.showSuccess("Impresora eliminado correctamente"),this.ngOnInit()):(console.log(a),this.notificationService.showError(a.message))})})}generateReport(){}openEdit(t){this.printerService.getDetailOfPrinter(t._id).subscribe(r=>{1==r.code&&this.dialog.open(P,{width:"1000px",data:{printer:r.data,isEdit:!0,sucursalData:r.sucursalData,optionsForModel:this.modelPrinters,optionsForSoftware:this.softwaresArray,optionsForPrecintos:this.precintos,optionsForClients:this.clients}}).afterClosed().subscribe(a=>{a&&(a.sucursal&&"N/A"==a.sucursal&&(a.sucursal=null),this.printerService.updatePrinter(t._id,a).subscribe(n=>{1==n.code?(this.notificationService.showSuccess("Impresora actualizada correctamente"),this.ngOnInit()):this.notificationService.showError("Error al actualizar la impresora")}))})})}static{this.\u0275fac=function(r){return new(r||i)(e.rXU(k.k),e.rXU(H._),e.rXU(I.J),e.rXU(E.u),e.rXU(m.bZ))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-printers"]],decls:11,vars:6,consts:[[1,"printers-container"],[1,"title"],[4,"ngIf"],["mat-raised-button","","color","primary","class","add-button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"add-button",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8","printers-table",3,"dataSource"],["matColumnDef","modelo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","serial"],["matColumnDef","precinto"],["matColumnDef","estado"],["matColumnDef","firmwareVersion"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-stroked-button","","color","accent",2,"margin-right","5px",3,"click"],["mat-flat-button","","color","warn","style","margin-right: 5px;",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","style","margin-right: 5px;",3,"click",4,"ngIf"],["mat-flat-button","","color","warn",2,"margin-right","5px",3,"click"],["mat-raised-button","","color","primary",2,"margin-right","5px",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,o){1&r&&(e.j41(0,"div",0)(1,"h2",1),e.EFF(2,"Lista de Impresoras "),e.DNE(3,J,2,0,"span",2),e.k0s(),e.DNE(4,L,4,0,"button",3),e.nrm(5,"br")(6,"br"),e.DNE(7,Z,4,0,"button",4)(8,fe,22,3,"div",2)(9,ue,3,0,"div",2)(10,ge,3,0,"div",2),e.k0s()),2&r&&(e.R7$(3),e.Y8G("ngIf",1==o.typeOfUser),e.R7$(),e.Y8G("ngIf",0==o.typeOfUser),e.R7$(3),e.Y8G("ngIf",0==o.typeOfUser),e.R7$(),e.Y8G("ngIf",o.printers&&o.printers.length>0),e.R7$(),e.Y8G("ngIf",o.isLoading),e.R7$(),e.Y8G("ngIf",!o.printers||0===o.printers.length&&!o.isLoading))},dependencies:[f.MD,f.bT,C.Hu,g.Hl,g.$z,_.m_,_.An,d.tP,d.Zl,d.tL,d.ji,d.cC,d.YV,d.iL,d.KS,d.$R,d.YZ,d.NB],styles:[".printers-container[_ngcontent-%COMP%]{position:relative;padding:16px}.title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin-bottom:16px;color:#3f51b5}.printers-table[_ngcontent-%COMP%]{width:100%;margin-top:40px}.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:left}.mat-header-cell[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:700;border-bottom:2px solid #e0e0e0}.mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.mat-row[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.mat-button[_ngcontent-%COMP%]{color:#1976d2}.mat-elevation-z8[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b}.add-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px}"]})}}return i})()}]}]}}]);