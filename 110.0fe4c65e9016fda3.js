"use strict";(self.webpackChunkModernize=self.webpackChunkModernize||[]).push([[110],{2110:(tt,_,s)=>{s.r(_),s.d(_,{ClientsRoutes:()=>Q});var m=s(4006),d=s(9417),u=s(177),E=s(5596),p=s(8834),g=s(9213),r=s(9159),C=s(2102),x=s(9631),k=s(2798),t=s(4438),f=s(1626),I=s(7673),b=s(8141),h=s(9437),S=s(5312),v=s(7473);let j=(()=>{class i{constructor(e,n){this.http=e,this.notificationService=n,this.apiUrl=S.c.apiUrl+"/clients"}getClients(){const e=(new f.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.get(`${this.apiUrl}`,{headers:e}).pipe((0,b.M)(n=>{console.log("Clients fetched successfully",n)}),(0,h.W)(this.handleError("getClients",[])))}getClient(e){const n=(new f.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.get(`${this.apiUrl}/${e}`,{headers:n}).pipe((0,b.M)(o=>{console.log("Client fetched successfully",o)}),(0,h.W)(this.handleError("getClient",{})))}createClient(e){const n=(new f.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.post(`${this.apiUrl}`,e,{headers:n}).pipe((0,h.W)(this.handleError("createClient",{})))}updateClient(e,n){const o=(new f.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.put(`${this.apiUrl}/${e}`,n,{headers:o}).pipe((0,h.W)(this.handleError("updateClient",{})))}deleteClient(e){const n=(new f.Lr).set("x-auth-token",localStorage.getItem("authToken")||"");return this.http.delete(`${this.apiUrl}/${e}`,{headers:n}).pipe((0,b.M)(o=>{console.log("Client deleted successfully",o),this.notificationService.showSuccess("Client deleted successfully")}),(0,h.W)(this.handleError("deleteClient",{})))}handleError(e="operation",n){return o=>(console.error(o),this.notificationService.showError(`${e} failed: ${o.message}`),(0,I.of)(n))}static{this.\u0275fac=function(n){return new(n||i)(t.KVO(f.Qq),t.KVO(v.J))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var R=s(3);function T(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"div",3)(2,"mat-form-field",14)(3,"mat-label"),t.EFF(4,"Nombre"),t.k0s(),t.nrm(5,"input",29),t.k0s(),t.j41(6,"mat-form-field",14)(7,"mat-label"),t.EFF(8,"Direcci\xf3n"),t.k0s(),t.nrm(9,"input",16),t.k0s()(),t.j41(10,"div",3)(11,"mat-form-field",14)(12,"mat-label"),t.EFF(13,"Tel\xe9fono"),t.k0s(),t.nrm(14,"input",17),t.k0s(),t.j41(15,"mat-form-field",14)(16,"mat-label"),t.EFF(17,"Estado"),t.k0s(),t.nrm(18,"input",30),t.k0s()(),t.j41(19,"div",3)(20,"mat-form-field",14)(21,"mat-label"),t.EFF(22,"Ciudad"),t.k0s(),t.nrm(23,"input",31),t.k0s(),t.j41(24,"button",32),t.bIt("click",function(){const o=t.eBV(e).index,a=t.XpG();return t.Njj(a.removeSucursal(o))}),t.j41(25,"mat-icon"),t.EFF(26,"delete"),t.k0s()()()()}if(2&i){const e=l.index,n=t.XpG();t.Y8G("formGroupName",e),t.R7$(24),t.Y8G("disabled",!n.isEdit)}}function D(i,l){if(1&i){const e=t.RV6();t.j41(0,"button",33),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.addSucursal())}),t.EFF(1,"Agregar Sucursal"),t.k0s()}}function y(i,l){if(1&i){const e=t.RV6();t.j41(0,"button",34),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.onSave())}),t.EFF(1,"Guardar"),t.k0s()}}let F=(()=>{class i{constructor(e,n,o,a,c){this.fb=e,this.dialogRef=n,this.clientsService=o,this.notificationService=a,this.data=c,this.isAdd=!1,this.letraRif="",this.rif="",this.isEdit=c.isEdit,this.isAdd=c.isAdd,console.log(c.client),c.client&&!this.isAdd?(this.letraRif=c.client?c.client.rif.charAt(0):"",this.rif=c.client?c.client.rif.substring(2):"",this.clientForm=this.fb.group({letraRIF:[{value:c.client?c.client.rif.charAt(0):"",disabled:!this.isEdit}],rif:[{value:c.client?c.client.rif.substring(2):"",disabled:!this.isEdit}],nombreFiscal:[{value:c.client.nombreFiscal,disabled:!this.isEdit}],direccion:[{value:c.client.direccion,disabled:!this.isEdit}],telefono:[{value:c.client.telefono,disabled:!this.isEdit}],email:[{value:c.client.email,disabled:!this.isEdit}],contactoPrincipal:[{value:c.client.contactoPrincipal,disabled:!this.isEdit}],sucursales:this.fb.array(c.client.sucursales?c.client.sucursales.map(q=>this.createSucursalFormGroup(q)):[])})):this.clientForm=this.fb.group({letraRIF:[{value:"",disabled:!this.isEdit}],rif:[{value:"",disabled:!this.isEdit}],nombreFiscal:[{value:"",disabled:!this.isEdit}],direccion:[{value:"",disabled:!this.isEdit}],telefono:[{value:"",disabled:!this.isEdit}],email:[{value:"",disabled:!this.isEdit}],contactoPrincipal:[{value:"",disabled:!this.isEdit}],sucursales:this.fb.array([])})}ngOnInit(){document.getElementById("letraRIF")?.focus(),document.getElementById("dialog")?.scrollTo(0,0)}get sucursales(){return this.clientForm.get("sucursales")}createSucursalFormGroup(e){return this.fb.group({nombre:[{value:e.nombre,disabled:!this.isEdit}],direccion:[{value:e.direccion,disabled:!this.isEdit}],telefono:[{value:e.telefono,disabled:!this.isEdit}],estado:[{value:e.estado,disabled:!this.isEdit}],ciudad:[{value:e.ciudad,disabled:!this.isEdit}]})}addSucursal(){this.sucursales.push(this.createSucursalFormGroup({}))}removeSucursal(e){this.sucursales.removeAt(e)}onSave(){let e=this.clientForm.value;this.isAdd?this.clientsService.createClient(e).subscribe(n=>{1==n.code?(this.notificationService.showSuccess("Cliente creado correctamente"),this.dialogRef.close(e)):this.notificationService.showError(n.message)}):this.isEdit?this.clientsService.updateClient(this.data.client._id,e).subscribe(n=>{1==n.code?(this.notificationService.showSuccess("Cliente actualizado correctamente"),this.dialogRef.close(this.clientForm.value)):this.notificationService.showError(n.message)}):this.dialogRef.close()}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(d.ok),t.rXU(m.CP),t.rXU(j),t.rXU(v.J),t.rXU(m.Vh))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-client-dialog"]],decls:58,vars:5,consts:[["mat-dialog-title","",2,"font-size","24px","font-weight","bold","color","#3f51b5","text-align","center","margin-bottom","16px"],["mat-dialog-content","",2,"display","flex","flex-direction","column","gap","16px","padding","16px"],[2,"display","flex","flex-direction","column","gap","16px",3,"formGroup"],[2,"display","flex","gap","16px"],["appearance","outline","id","letraRIF",2,"flex","0.3"],["formControlName","letraRIF"],["value","V"],["value","E"],["value","J"],["value","P"],["value","G"],["value","C"],["appearance","outline",2,"flex","0.5"],["matInput","","formControlName","rif"],["appearance","outline",2,"flex","1"],["matInput","","formControlName","nombreFiscal"],["matInput","","formControlName","direccion"],["matInput","","formControlName","telefono"],["matInput","","formControlName","email"],["matInput","","formControlName","contactoPrincipal"],[2,"display","flex","flex-direction","column","gap","16px"],[2,"margin","0"],["formArrayName","sucursales"],["style","display: flex; flex-direction: column; gap: 16px;",3,"formGroupName",4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-dialog-actions","",2,"display","flex","justify-content","flex-end","gap","8px","margin-top","16px"],["mat-button","",3,"click"],["mat-flat-button","",3,"click",4,"ngIf"],[2,"display","flex","flex-direction","column","gap","16px",3,"formGroupName"],["matInput","","formControlName","nombre"],["matInput","","formControlName","estado"],["matInput","","formControlName","ciudad"],["mat-icon-button","","color","warn",3,"click","disabled"],["mat-stroked-button","","color","primary",3,"click"],["mat-flat-button","",3,"click"]],template:function(n,o){if(1&n&&(t.j41(0,"h1",0),t.EFF(1),t.k0s(),t.j41(2,"div",1)(3,"form",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-label"),t.EFF(7,"Documento"),t.k0s(),t.j41(8,"mat-select",5)(9,"mat-option",6),t.EFF(10,"V"),t.k0s(),t.j41(11,"mat-option",7),t.EFF(12,"E"),t.k0s(),t.j41(13,"mat-option",8),t.EFF(14,"J"),t.k0s(),t.j41(15,"mat-option",9),t.EFF(16,"P"),t.k0s(),t.j41(17,"mat-option",10),t.EFF(18,"G"),t.k0s(),t.j41(19,"mat-option",11),t.EFF(20,"C"),t.k0s()()(),t.j41(21,"mat-form-field",12)(22,"mat-label"),t.EFF(23,"RIF"),t.k0s(),t.nrm(24,"input",13),t.k0s()(),t.j41(25,"div",3)(26,"mat-form-field",14)(27,"mat-label"),t.EFF(28,"Nombre Fiscal"),t.k0s(),t.nrm(29,"input",15),t.k0s()(),t.j41(30,"div",3)(31,"mat-form-field",14)(32,"mat-label"),t.EFF(33,"Direcci\xf3n"),t.k0s(),t.nrm(34,"input",16),t.k0s(),t.j41(35,"mat-form-field",14)(36,"mat-label"),t.EFF(37,"Tel\xe9fono"),t.k0s(),t.nrm(38,"input",17),t.k0s()(),t.j41(39,"div",3)(40,"mat-form-field",14)(41,"mat-label"),t.EFF(42,"Email"),t.k0s(),t.nrm(43,"input",18),t.k0s(),t.j41(44,"mat-form-field",14)(45,"mat-label"),t.EFF(46,"Contacto Principal"),t.k0s(),t.nrm(47,"input",19),t.k0s()(),t.j41(48,"div",20)(49,"h3",21),t.EFF(50,"Sucursales"),t.k0s(),t.j41(51,"div",22),t.DNE(52,T,27,2,"div",23),t.k0s(),t.DNE(53,D,2,0,"button",24),t.k0s()()(),t.j41(54,"div",25)(55,"button",26),t.bIt("click",function(){return o.onCancel()}),t.EFF(56,"Cancelar"),t.k0s(),t.DNE(57,y,2,0,"button",27),t.k0s()),2&n){let a;t.R7$(),t.SpI(" ",o.isAdd?"Nuevo Cliente":(o.isEdit?"Editar Cliente ":"Ver Cliente ")+((null==(a=o.clientForm.get("nombreFiscal"))?null:a.value)||"")," "),t.R7$(2),t.Y8G("formGroup",o.clientForm),t.R7$(49),t.Y8G("ngForOf",o.sucursales.controls),t.R7$(),t.Y8G("ngIf",o.isEdit),t.R7$(4),t.Y8G("ngIf",o.isEdit||o.isAdd)}},dependencies:[u.MD,u.Sq,u.bT,E.Hu,p.Hl,p.$z,p.iY,g.m_,g.An,r.tP,m.hM,m.BI,m.E7,m.Yi,d.X1,d.qT,d.me,d.BC,d.cb,d.j4,d.JD,d.$R,d.v8,C.RG,C.rl,C.nJ,x.fS,x.fg,k.Ve,k.VO,R.wT],styles:['@charset "UTF-8";.mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}.dialog-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:16px}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-field[_ngcontent-%COMP%]{width:100%}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px}.mat-form-field-disabled[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]{opacity:.7}  .mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 70%, transparent))!important}']})}}return i})();var P=s(8257),O=s(4796);function $(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," RIF "),t.k0s())}function M(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.rif," ")}}function N(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Nombre Fiscal "),t.k0s())}function w(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.nombreFiscal," ")}}function G(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Direcci\xf3n "),t.k0s())}function V(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.direccion," ")}}function U(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Tel\xe9fono "),t.k0s())}function A(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.telefono," ")}}function X(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Email "),t.k0s())}function Y(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.email," ")}}function B(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Contacto Principal "),t.k0s())}function z(i,l){if(1&i&&(t.j41(0,"td",17),t.EFF(1),t.k0s()),2&i){const e=l.$implicit;t.R7$(),t.SpI(" ",e.contactoPrincipal," ")}}function H(i,l){1&i&&(t.j41(0,"th",16),t.EFF(1," Acciones "),t.k0s())}function L(i,l){if(1&i){const e=t.RV6();t.j41(0,"td",17)(1,"div",18)(2,"button",19),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.openView(o))}),t.EFF(3,"Detalles"),t.k0s(),t.j41(4,"button",20),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.openEdit(o))}),t.EFF(5,"Editar"),t.k0s(),t.j41(6,"button",21),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG(2);return t.Njj(a.deleteClient(o._id))}),t.EFF(7,"Borrar"),t.k0s()()()}}function J(i,l){1&i&&t.nrm(0,"tr",22)}function W(i,l){1&i&&t.nrm(0,"tr",23)}function K(i,l){if(1&i&&(t.j41(0,"div")(1,"table",4),t.qex(2,5),t.DNE(3,$,2,0,"th",6)(4,M,2,1,"td",7),t.bVm(),t.qex(5,8),t.DNE(6,N,2,0,"th",6)(7,w,2,1,"td",7),t.bVm(),t.qex(8,9),t.DNE(9,G,2,0,"th",6)(10,V,2,1,"td",7),t.bVm(),t.qex(11,10),t.DNE(12,U,2,0,"th",6)(13,A,2,1,"td",7),t.bVm(),t.qex(14,11),t.DNE(15,X,2,0,"th",6)(16,Y,2,1,"td",7),t.bVm(),t.qex(17,12),t.DNE(18,B,2,0,"th",6)(19,z,2,1,"td",7),t.bVm(),t.qex(20,13),t.DNE(21,H,2,0,"th",6)(22,L,8,0,"td",7),t.bVm(),t.DNE(23,J,1,0,"tr",14)(24,W,1,0,"tr",15),t.k0s()()),2&i){const e=t.XpG();t.R7$(),t.Y8G("dataSource",e.clients),t.R7$(22),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",e.displayedColumns)}}function Z(i,l){1&i&&(t.j41(0,"div")(1,"p"),t.EFF(2,"No hay clientes disponibles."),t.k0s()())}const Q=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"",children:[{path:"list",component:(()=>{class i{constructor(e,n,o,a){this.clientsService=e,this.notificationService=n,this.authService=o,this.dialog=a,this.clients=[],this.typeOfUser=5,this.displayedColumns=["rif","nombreFiscal","direccion","telefono","email","contactoPrincipal","acciones"]}ngOnInit(){this.authService.getTypeOfUser().subscribe(e=>{this.typeOfUser=e}),this.clientsService.getClients().subscribe(e=>{1==e.code?this.clients=e.data:this.notificationService.showError(e.message)})}openView(e){this.dialog.open(F,{width:"600px",data:{client:e,isEdit:!1,isAdd:!1}})}openEdit(e){this.dialog.open(F,{width:"600px",data:{client:e,isEdit:!0}}).afterClosed().subscribe(o=>{o&&(this.ngOnInit(),console.log(o))})}deleteClient(e){this.dialog.open(P.D,{width:"400px",data:{message:"\xbfEst\xe1 seguro de que desea eliminar este cliente?"}}).afterClosed().subscribe(o=>{o&&this.clientsService.deleteClient(e).subscribe(a=>{1==a.code?(this.notificationService.showSuccess("Cliente eliminado correctamente"),this.ngOnInit()):(console.log(a),this.notificationService.showError(a.message))})})}openAddClient(){this.dialog.open(F,{width:"1000px",data:{client:{},isAdd:!0,isEdit:!0}}).afterClosed().subscribe(n=>{n&&(this.ngOnInit(),console.log(n))})}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(j),t.rXU(v.J),t.rXU(O.u),t.rXU(m.bZ))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-clients"]],decls:9,vars:2,consts:[[1,"clients-container"],[1,"title"],["mat-raised-button","","color","primary",1,"add-button",3,"click"],[4,"ngIf"],["mat-table","",1,"mat-elevation-z8","clients-table",3,"dataSource"],["matColumnDef","rif"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombreFiscal"],["matColumnDef","direccion"],["matColumnDef","telefono"],["matColumnDef","email"],["matColumnDef","contactoPrincipal"],["matColumnDef","acciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[2,"display","flex","gap","5px"],["mat-stroked-button","","color","accent",3,"click"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","",1,"warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"h2",1),t.EFF(2,"Lista de Clientes"),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return o.openAddClient()}),t.j41(4,"mat-icon"),t.EFF(5,"add"),t.k0s(),t.EFF(6," Agregar Cliente "),t.k0s(),t.DNE(7,K,25,3,"div",3)(8,Z,3,0,"div",3),t.k0s()),2&n&&(t.R7$(7),t.Y8G("ngIf",o.clients&&o.clients.length>0),t.R7$(),t.Y8G("ngIf",!o.clients||0===o.clients.length))},dependencies:[u.MD,u.bT,E.Hu,p.Hl,p.$z,g.m_,g.An,r.tP,r.Zl,r.tL,r.ji,r.cC,r.YV,r.iL,r.KS,r.$R,r.YZ,r.NB],styles:[".warn[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}.clients-container[_ngcontent-%COMP%]{position:relative;padding:16px}.add-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px}.clients-table[_ngcontent-%COMP%]{width:100%;margin-top:40px}.mat-header-cell[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:700}.printers-container[_ngcontent-%COMP%]{padding:16px}.title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin-bottom:16px;color:#3f51b5}.printers-table[_ngcontent-%COMP%]{width:100%;margin:16px 0;border-collapse:collapse}.mat-header-cell[_ngcontent-%COMP%], .mat-cell[_ngcontent-%COMP%]{padding:16px;text-align:left}.mat-header-cell[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:700;border-bottom:2px solid #e0e0e0}.mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.mat-row[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.mat-button[_ngcontent-%COMP%]{color:#1976d2}.mat-elevation-z8[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b}"]})}}return i})()}]}]}}]);